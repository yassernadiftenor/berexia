<h3 class="first">Employees</h3>
<button nz-button [nzType]="'primary'" (click)="showModal()" *ngIf="Access()"><span><i nz-icon nzType="plus" nzTheme="outline"></i>Add new Employe</span></button>
<button nz-button [nzType]="'primary'" (click)="exportAsXLSX()"><i nz-icon nzType="file-excel" nzTheme="outline"></i>Export to Excel</button>
<nz-modal [(nzVisible)]="deptVisible" nzTitle="Add new departement" [nzFooter]="addNewEmployeDept"(nzOnCancel)="handleCancel1()">
  <form nz-form [formGroup]="formular1">
    <p>Nom Departement :</p>
    <input nz-input placeholder="Name departement" [formControlName]="'nomDepart'" nzSize="default"
           [ngModel]="selectedDep1?.nomDepart"/>
    <p>Capacite :</p>
    <nz-input-number [formControlName]="'capacite'"
                     [ngModel]="selectedDep1?.capacite" [nzMin]="1" [nzMax]="1000000" [nzStep]="1"></nz-input-number>


  </form>
  <ng-template #addNewEmployeDept>
    <button nz-button nzType="default" (click)="handleCancel1()">Cancel</button>
    <button nz-button nzType="primary" (click)="handleOk1()" [disabled]="!formular1.valid">valider</button>
  </ng-template>
</nz-modal>








<nz-modal [(nzVisible)]="isVisible" nzTitle="Add new Employe" [nzFooter]="addNewEmploye"  (nzOnCancel)="handleCancel()">
  <form nz-form [formGroup]="formular">
    <p>Nom Employe :</p>
    <input nz-input placeholder="Last Name Employe" [formControlName]="'nomEmploye'" nzSize="default"
           [ngModel]="selectedDep?.nomEmploye"/>
    <p>Prenom Employe :</p>
    <input nz-input placeholder="first Name Employe" [formControlName]="'prenomEmploye'" nzSize="default"
           [ngModel]="selectedDep?.prenomEmploye"/>
    <p>Ville Employe :</p>
    <input nz-input placeholder="City Employe" [formControlName]="'ville'" nzSize="default"
           [ngModel]="selectedDep?.ville"/>
    <p>Departement Employe :</p>
    <nz-select [(ngModel)]="listDepart" nzPlaceHolder="Departement name" [formControlName]="'departement'">
      <nz-option *ngFor="let option of listOfDepartement" [nzValue]="option.value" [nzLabel]="option.label"></nz-option>
    </nz-select>
   <p>Ne voyez-vous pas votre d√©partement ?</p>
    <button nz-button nzType="primary" (click)="showDepartModal()" [disabled]="buttonInvisible">Ajouter un departement</button>

  </form>
  <ng-template #addNewEmploye>
    <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
    <button nz-button nzType="primary" (click)="handleOk()" [disabled]="!formular.valid">valider</button>
  </ng-template>
</nz-modal>
<nz-input-group nzSearch nzSize="large" [nzAddOnAfter]="suffixButton">
  <input type="text" nz-input placeholder="input search text" (input)="search()" [(ngModel)]="searchword"/>
</nz-input-group>
<ng-template #suffixButton>

</ng-template>
<p-table [columns]="cols" [value]="employe">
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th *ngFor="let col of columns">
        {{col.header}}
      </th>
      <th>
        idDepart
     </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowData let-columns="columns">
    <tr>
      <td *ngFor="let col of columns">
        {{rowData[col.field]}}

      </td >
      <td>
        {{rowData['departement'].idDepart}}
      </td>
      <td *ngIf="Access()">
        <button nz-button nzType="primary" *ngIf="Access()" (click)="update(rowData)"><i nz-icon nzType="edit" nzTheme="outline"></i>Update</button>
      </td>
      <td *ngIf="Access()">
        <button nz-button nzType="primary" nz-popconfirm
                nzPopconfirmTitle="Are you sure delete this task?"
                (nzOnConfirm)="delete(rowData.idEmploye)"
                (nzOnCancel)="handleCancel()"
                *ngIf="Access()"
                nzPopconfirmPlacement="bottomLeft"
                nz-button ><i nz-icon nzType="delete" nzTheme="outline"></i>Delete</button>
      </td>
    </tr>
  </ng-template>
</p-table>
